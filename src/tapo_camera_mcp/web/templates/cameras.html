{% extends "base.html" %}

{% block title %}Cameras - Home Security MCP{% endblock %}

{% block extra_css %}
<style>
    .cameras-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .camera-card {
        background: white;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        border: 1px solid #e5e7eb;
        transition: all 0.2s ease-in-out;
    }

    .camera-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    .camera-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid #e5e7eb;
    }

    .camera-name {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1f2937;
        margin: 0;
    }

    .status-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .status-online {
        background-color: #dcfce7;
        color: #166534;
    }

    .status-offline {
        background-color: #fef3c7;
        color: #92400e;
    }

    .status-error {
        background-color: #fee2e2;
        color: #991b1b;
    }

    .camera-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1.25rem;
    }

    .detail-item {
        display: flex;
        flex-direction: column;
    }

    .detail-label {
        font-size: 0.75rem;
        font-weight: 500;
        color: #6b7280;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.25rem;
    }

    .detail-value {
        font-size: 0.875rem;
        color: #1f2937;
        font-weight: 500;
    }

    .capabilities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 0.75rem;
        margin-top: 1rem;
    }

    .capability-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem;
        background-color: #f9fafb;
        border-radius: 0.375rem;
        border: 1px solid #e5e7eb;
    }

    .capability-icon {
        width: 1rem;
        height: 1rem;
        color: #6b7280;
    }

    .capability-supported .capability-icon {
        color: #16a34a;
    }

    .capability-name {
        font-size: 0.75rem;
        font-weight: 500;
        color: #374151;
    }

    .camera-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid #e5e7eb;
    }

    .action-button {
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-size: 0.875rem;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.2s ease-in-out;
        border: 1px solid #d1d5db;
        background-color: white;
        color: #374151;
    }

    .action-button:hover {
        background-color: #f9fafb;
        border-color: #9ca3af;
    }

    .action-button-primary {
        background-color: #3b82f6;
        color: white;
        border-color: #3b82f6;
    }

    .action-button-primary:hover {
        background-color: #2563eb;
        border-color: #2563eb;
    }

    .stats-overview {
        background: white;
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        border: 1px solid #e5e7eb;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
    }

    .stat-item {
        text-align: center;
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: #1f2937;
        line-height: 1;
    }

    .stat-label {
        font-size: 0.875rem;
        color: #6b7280;
        font-weight: 500;
        margin-top: 0.25rem;
    }

    .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: #6b7280;
    }

    .empty-state-icon {
        width: 4rem;
        height: 4rem;
        margin: 0 auto 1rem;
        opacity: 0.5;
    }

    .empty-state-title {
        font-size: 1.125rem;
        font-weight: 500;
        color: #374151;
        margin-bottom: 0.5rem;
    }

    .empty-state-description {
        font-size: 0.875rem;
        color: #6b7280;
    }

    @media (max-width: 768px) {
        .cameras-grid {
            grid-template-columns: 1fr;
        }

        .camera-details {
            grid-template-columns: 1fr;
        }

        .capabilities-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .camera-actions {
            flex-direction: column;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Page Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Cameras</h1>
        <p class="text-gray-600">Manage and monitor your security cameras</p>
    </div>

    <!-- Stats Overview -->
    <div class="stats-overview">
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value">{{ total_cameras }}</div>
                <div class="stat-label">Total Cameras</div>
            </div>
            <div class="stat-item">
                <div class="stat-value text-green-600">{{ online_cameras }}</div>
                <div class="stat-label">Online</div>
            </div>
            <div class="stat-item">
                <div class="stat-value text-yellow-600">{{ total_cameras - online_cameras }}</div>
                <div class="stat-label">Offline</div>
            </div>
            <div class="stat-item">
                <div class="stat-value text-blue-600">{{ total_cameras }}</div>
                <div class="stat-label">Configured</div>
            </div>
        </div>
    </div>

    <!-- Cameras Grid -->
    {% if cameras %}
    <div class="cameras-grid">
        {% for camera in cameras %}
        <div class="camera-card">
            <!-- Camera Header -->
            <div class="camera-header">
                <h3 class="camera-name">{{ camera.name }}</h3>
                <span class="status-badge status-{{ 'online' if camera.status == 'online' else 'offline' if camera.status == 'offline' else 'error' }}">
                    {{ camera.status|title if camera.status else 'Unknown' }}
                </span>
            </div>

            <!-- Camera Details -->
            <div class="camera-details">
                <div class="detail-item">
                    <span class="detail-label">Type</span>
                    <span class="detail-value">{{ camera.type|title }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Model</span>
                    <span class="detail-value">{{ camera.model|default('Unknown') }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Resolution</span>
                    <span class="detail-value">{{ camera.resolution|default('Unknown') }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Firmware</span>
                    <span class="detail-value">{{ camera.firmware|default('Unknown') }}</span>
                </div>
            </div>

            <!-- Capabilities -->
            <div class="capabilities-grid">
                <div class="capability-item {% if camera.ptz_capable %}capability-supported{% endif %}">
                    <svg class="capability-icon" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="capability-name">PTZ</span>
                </div>
                <div class="capability-item {% if camera.audio_capable %}capability-supported{% endif %}">
                    <svg class="capability-icon" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.816L4.414 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.414l3.969-3.816a1 1 0 011.234 0zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="capability-name">Audio</span>
                </div>
                <div class="capability-item {% if camera.streaming_capable %}capability-supported{% endif %}">
                    <svg class="capability-icon" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm3 7a1 1 0 011-1h.01a1 1 0 110 2H8a1 1 0 01-1-1zm3-1a1 1 0 100 2h.01a1 1 0 100-2H10zm-2 4a1 1 0 011-1h.01a1 1 0 110 2H9a1 1 0 01-1-1zm6-4a1 1 0 100 2h.01a1 1 0 100-2H14zm-2 4a1 1 0 011-1h.01a1 1 0 110 2H12a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="capability-name">Streaming</span>
                </div>
                <div class="capability-item capability-supported">
                    <svg class="capability-icon" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6zm2 2a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="capability-name">Capture</span>
                </div>
            </div>

            <!-- Status Indicators -->
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-4 text-sm">
                    <div class="flex items-center gap-1">
                        <span class="font-medium">Stream:</span>
                        <span class="w-3 h-3 rounded-full {{ 'bg-green-500' if camera.streaming_capable else 'bg-red-500' }}"></span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span class="font-medium">Audio:</span>
                        <span class="w-3 h-3 rounded-full {{ 'bg-green-500' if camera.audio_capable else 'bg-red-500' }}"></span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span class="font-medium">PTZ:</span>
                        <span class="w-3 h-3 rounded-full {{ 'bg-green-500' if camera.ptz_capable else 'bg-red-500' }}"></span>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            {% if camera.status == 'online' %}
            <div class="camera-actions">
                <button onclick="window.open('/api/cameras/{{ camera.name }}/stream', 'stream-{{ camera.name }}', 'width=800,height=600')" class="action-button action-button-primary">
                    <svg class="w-4 h-4 mr-1 inline" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path>
                    </svg>
                    Start Stream
                </button>
                <button onclick="alert('Audio recording not implemented yet - coming soon!')" class="action-button">
                    <svg class="w-4 h-4 mr-1 inline" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0 5 5 0 01-10 0 1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z" clip-rule="evenodd"></path>
                    </svg>
                    🔊 Audio
                </button>
                <button onclick="window.open('/api/cameras/{{ camera.name }}/snapshot', 'snapshot-{{ camera.name }}', 'width=800,height=600')" class="action-button">
                    <svg class="w-4 h-4 mr-1 inline" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm3 7a1 1 0 011-1h.01a1 1 0 110 2H8a1 1 0 01-1-1zm3-1a1 1 0 100 2h.01a1 1 0 100-2H10zm-2 4a1 1 0 011-1h.01a1 1 0 110 2H9a1 1 0 01-1-1zm6-4a1 1 0 100 2h.01a1 1 0 100-2H14zm-2 4a1 1 0 011-1h.01a1 1 0 110 2H12a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                    </svg>
                    📸 Snapshot
                </button>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- Empty State -->
    <div class="empty-state">
        <svg class="empty-state-icon" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
        </svg>
        <h3 class="empty-state-title">No Cameras Configured</h3>
        <p class="empty-state-description">
            Get started by adding your first camera to the system. Configure IP cameras, webcams, or connect to cloud services.
        </p>
    </div>
    {% endif %}
    </div>

{% endblock %}
